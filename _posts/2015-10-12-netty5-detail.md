---
layout: post
title: 'Netty5的启动说明，帮助理解netty5对NIO的封装'
description: "netty5, NIO,SocketChannel"
category: netty
tags: [netty,NIO,SocketChannel]
---
{% include JB/setup %}

Netty5: ServerSocketChannel启动说明： 以NettyExample 里EchoServer为例

```java
	//EventLoop相当于线程，会在run()方法里不断的执行Selector.select(timeout)方法
	//如果有就绪的事件，就创建一个处理对应事件的任务丢进线程池里执行。

	//下边EventLoopGroup就是线程池。
        EventLoopGroup bossGroup = new NioEventLoopGroup(1);
        EventLoopGroup workerGroup = new NioEventLoopGroup();  //这里默认创建 cpu个数 * 2 个线程
        try {
            ServerBootstrap b = new ServerBootstrap();
            b.group(bossGroup, workerGroup)
             .channel(NioServerSocketChannel.class)
             .option(ChannelOption.SO_BACKLOG, 100)
             .handler(new LoggingHandler(LogLevel.INFO))
             .childHandler(new ChannelInitializer<SocketChannel>() {
                 @Override
                 public void initChannel(SocketChannel ch) throws Exception {
                     ChannelPipeline p = ch.pipeline();
                     if (sslCtx != null) {
                         p.addLast(sslCtx.newHandler(ch.alloc()));
                     }
                     //p.addLast(new LoggingHandler(LogLevel.INFO));
                     p.addLast(new EchoServerHandler());
                 }
             });

            // 以上都是设置参数和ChannelHandler ，下面调用bind()才是启动服务器.
	    // 相当于原生NIO调用
	    // ServerSocketChannel servch = ServerSocketChannel.open();
	    // servch.configureBlocking(false);
	    // selectKey = servch.register(selector , 0, null);  
	    // serverSocketChannel.bind();
 	    // selectKey.interestOps(SelectionKey.OP_ACCEPT);
	    // 因为Event是注册到bossGroup里的seletor上的，所以后边bossGroup就能不断的处理Accept事件了。

	    //Start the server.
            ChannelFuture f = b.bind(PORT).sync();

            // Wait until the server socket is closed.
            f.channel().closeFuture().sync();
```

那么Netty又是怎么处理Accept事件呢，看代码：ServerBootstrap 里有个ChannelHandler `ServerBootstrapAcceptor` 专门处理Accept事件.
来看看ServerBootstrapAcceptor的ChannelRead()方法是怎么处理的

```java
        public void channelRead(ChannelHandlerContext ctx, Object msg) {
	    
	   // 由于NioServerSocketChannel是AbstractNioMessageChannel的子类，
	   // 当有Accept事件就绪时就会调用AbstractNioMessageChannel.NioMessageUnsafe.read()方法，
	   // unSafe.read()里再调用NioServerSocketChannel.doReadMessages()方法，实现对serverSocketChannel.accept()的调用，完成三次握手，
	   // 并触发PipeLine的channelRead()方法，所以这里的参数msg是serverSocketChannel.accept()的返回结果: SocketChannel的封装类：NioSocketChannel

            final Channel child = (Channel) msg;

            child.pipeline().addLast(childHandler);

            for (Entry<ChannelOption<?>, Object> e: childOptions) {
                try {
                    if (!child.config().setOption((ChannelOption<Object>) e.getKey(), e.getValue())) {
                        logger.warn("Unknown channel option: " + e);
                    }
                } catch (Throwable t) {
                    logger.warn("Failed to set a channel option: " + child, t);
                }
            }

            for (Entry<AttributeKey<?>, Object> e: childAttrs) {
                child.attr((AttributeKey<Object>) e.getKey()).set(e.getValue());
            }

	    // 这里是注册childChannel的READ事件到workGroup线程池的一个线程上，让Selector 处理这个连接的Read事件。
        // 这里要注意一下 了 : netty的线程模型正是在这里体现的. 一个channel只会注册到一个EventLoop(线程)里,以后这个channel就由这个EventLoop负责了. 这样保证了channelHandler不会被多个线程调用. 避免了多线程并发的复杂性.
	    // 这样当有数据到达时，childGroup线程调用selector.select()方法会返回，并调用unSafe.read()方法。
	    // 最终会调用NioSocketChannel.doReadBytes()方法，完成数据读取,再触发PipeLine的channelRead()方法，跟Accep事件的处理一样的。
	    // 只是传给ChannelRead()方法的参数是Bytebuf.   
            try {
                childGroup.register(child).addListener(new ChannelFutureListener() {
                    @Override
                    public void operationComplete(ChannelFuture future) throws Exception {
                        if (!future.isSuccess()) {
                            forceClose(child, future.cause());
                        }
                    }
                });
            } catch (Throwable t) {
                forceClose(child, t);
            }
        }

```

上面介绍了Netty作为服务端处理Accept 和 Read. 下面看看是如何处理Connect的。 同样从EchoClient来看。

```java
	    // 前边都不说了，跟Server差不多，从这句开始是真正开始建立连接。相当于原生NIO代码的：
	    // SocketChannel clich = SocketChannel.open();
	    // clich.configureBlocking(false);
	    // selectKey = clich.register(selector , 0, null);  
	    // boolean connected = clich.connect(remoteAddress);
 	    // selectKey.interestOps(SelectionKey.OP_CONNECT);
	    // 当服务端accept之后，workGroup就会处理Connect事件了。并调用unsafe.finishConnect()方法完成三次握手。
	    // 之后处理READ事件。
            // Start the client.

            ChannelFuture f = b.connect(HOST, PORT).sync();
```

## netty的pipeline

<DIV>
<svg id="drawing" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="1475.6805419921875" height="476.67706298828125" viewBox="-20 -20 1475.6805419921875 476.67706298828125"><defs id="SvgjsDefs1001"><marker id="SvgjsMarker1046" markerWidth="16.23606797749979" markerHeight="10.550836550532098" refX="-1" refY="3.8990363547948754" viewBox="-1 -1.3763819204711738 16.23606797749979 10.550836550532098" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1047" d="M12 3.899036407470703L0 7.798072814941406V0Z " stroke="#323232" stroke-width="2" fill="#323232" transform="matrix(1,0,0,1,0,0)"></path></marker><marker id="SvgjsMarker1053" markerWidth="16.23606797749979" markerHeight="10.550836550532098" refX="-1" refY="3.8990363547948754" viewBox="-1 -1.3763819204711738 16.23606797749979 10.550836550532098" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1054" d="M12 3.899036407470703L0 7.798072814941406V0Z " stroke="#323232" stroke-width="2" fill="#323232" transform="matrix(1,0,0,1,0,0)"></path></marker><marker id="SvgjsMarker1060" markerWidth="16.23606797749979" markerHeight="10.550836550532098" refX="-1" refY="3.8990363547948754" viewBox="-1 -1.3763819204711738 16.23606797749979 10.550836550532098" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1061" d="M12 3.899036407470703L0 7.798072814941406V0Z " stroke="#323232" stroke-width="2" fill="#323232" transform="matrix(1,0,0,1,0,0)"></path></marker><marker id="SvgjsMarker1067" markerWidth="16.23606797749979" markerHeight="10.550836550532098" refX="-1" refY="3.8990363547948754" viewBox="-1 -1.3763819204711738 16.23606797749979 10.550836550532098" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1068" d="M12 3.899036407470703L0 7.798072814941406V0Z " stroke="#323232" stroke-width="2" fill="#323232" transform="matrix(1,0,0,1,0,0)"></path></marker><marker id="SvgjsMarker1098" markerWidth="16.23606797749979" markerHeight="10.550836550532098" refX="-1" refY="3.8990363547948754" viewBox="-1 -1.3763819204711738 16.23606797749979 10.550836550532098" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1099" d="M12 3.899036407470703L0 7.798072814941406V0Z " stroke="#323232" stroke-width="2" fill="#323232" transform="matrix(1,0,0,1,0,0)"></path></marker><marker id="SvgjsMarker1105" markerWidth="16.23606797749979" markerHeight="10.550836550532098" refX="-1" refY="3.8990363547948754" viewBox="-1 -1.3763819204711738 16.23606797749979 10.550836550532098" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1106" d="M12 3.899036407470703L0 7.798072814941406V0Z " stroke="#323232" stroke-width="2" fill="#323232" transform="matrix(1,0,0,1,0,0)"></path></marker><marker id="SvgjsMarker1112" markerWidth="16.23606797749979" markerHeight="10.550836550532098" refX="-1" refY="3.8990363547948754" viewBox="-1 -1.3763819204711738 16.23606797749979 10.550836550532098" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1113" d="M12 3.899036407470703L0 7.798072814941406V0Z " stroke="#323232" stroke-width="2" fill="#323232" transform="matrix(1,0,0,1,0,0)"></path></marker><marker id="SvgjsMarker1119" markerWidth="16.23606797749979" markerHeight="10.550836550532098" refX="-1" refY="3.8990363547948754" viewBox="-1 -1.3763819204711738 16.23606797749979 10.550836550532098" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1120" d="M12 3.899036407470703L0 7.798072814941406V0Z " stroke="#323232" stroke-width="2" fill="#323232" transform="matrix(1,0,0,1,0,0)"></path></marker><marker id="SvgjsMarker1136" markerWidth="16.23606797749979" markerHeight="10.550836550532098" refX="-1" refY="3.8990363547948754" viewBox="-1 -1.3763819204711738 16.23606797749979 10.550836550532098" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1137" d="M12 3.899036407470703L0 7.798072814941406V0Z " stroke="#323232" stroke-width="2" fill="#323232" transform="matrix(1,0,0,1,0,0)"></path></marker><marker id="SvgjsMarker1151" markerWidth="16.23606797749979" markerHeight="10.550836550532098" refX="-1" refY="3.8990363547948754" viewBox="-1 -1.3763819204711738 16.23606797749979 10.550836550532098" orient="auto" markerUnits="userSpaceOnUse"><path id="SvgjsPath1152" d="M12 3.899036407470703L0 7.798072814941406V0Z " stroke="#323232" stroke-width="2" fill="#323232" transform="matrix(1,0,0,1,0,0)"></path></marker></defs><g id="SvgjsG1007"><path id="SvgjsPath1008" d="M-20 -20H1455.6805419921875V456.67706298828125H-20V-20Z " fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1009"><g id="SvgjsG1010" transform="translate(322.0138854980469 127.75538112577158)" opacity="1"><path id="SvgjsPath1011" d="M0 0L972.4444580078125 0L972.4444580078125 308.92169189453125L0 308.92169189453125Z " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="#ffff99" opacity="1"></path><g id="SvgjsG1012" transform="matrix(1 0 0 1 10 146.33584856064937)" fill="#ffffff"><text id="SvgjsText1013" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="476.2222137451172" y="14.4375">ChannelPipeline</text></g></g><g id="SvgjsG1014" transform="translate(558.1529432879327 187.6207833896026)" opacity="1"><path id="SvgjsPath1015" d="M0 0L120.8609390258789 0L120.8609390258789 195.21360778808594L0 195.21360778808594Z " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="#ccff99" opacity="1"></path><g id="SvgjsG1016" transform="matrix(1 0 0 1 10 73.23180385189164)" fill="#ffffff"><text id="SvgjsText1017" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="50.43047110505708" y="14.4375">ChannelHandle</text><text id="SvgjsText1018" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="50.43047110505708" y="30.6875">rContext</text><text id="SvgjsText1019" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="50.43047110505708" y="32.5"></text></g></g><g id="SvgjsG1020" transform="translate(584.4856355767854 254.40438602510739)" opacity="1"><path id="SvgjsPath1021" d="M0 4Q0 0 4 0L67.67227935791016 0Q71.67227935791016 0 71.67227935791016 4L71.67227935791016 115.86800384521484Q71.67227935791016 119.86800384521484 67.67227935791016 119.86800384521484L4 119.86800384521484Q0 119.86800384521484 0 115.86800384521484Z " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="#99ffff" opacity="1"></path><g id="SvgjsG1022" transform="matrix(1 0 0 1 10 43.68400236519663)" fill="#ffffff"><text id="SvgjsText1023" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="25.836140249520085" y="14.4375">Handle</text><text id="SvgjsText1024" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="25.836140249520085" y="30.6875">r</text></g></g><g id="SvgjsG1025" transform="translate(752.4166313392761 187.6207833896026)" opacity="1"><path id="SvgjsPath1026" d="M0 0L124.19451141357422 0L124.19451141357422 195.21360778808594L0 195.21360778808594Z " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="#ccff99" opacity="1"></path><g id="SvgjsG1027" transform="matrix(1 0 0 1 10 81.35680385189164)" fill="#ffffff"><text id="SvgjsText1028" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="52.09725415877075" y="14.4375">ChannelHandle</text><text id="SvgjsText1029" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="52.09725415877075" y="30.6875">rContext</text></g></g><g id="SvgjsG1030" transform="translate(779.4756275020374 254.40438602510739)" opacity="1"><path id="SvgjsPath1031" d="M0 4Q0 0 4 0L69.64913177490234 0Q73.64913177490234 0 73.64913177490234 4L73.64913177490234 115.86800384521484Q73.64913177490234 119.86800384521484 69.64913177490234 119.86800384521484L4 119.86800384521484Q0 119.86800384521484 0 115.86800384521484Z " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="#99ffff" opacity="1"></path><g id="SvgjsG1032" transform="matrix(1 0 0 1 10 43.68400236519663)" fill="#ffffff"><text id="SvgjsText1033" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="26.82456662095388" y="14.4375">Handle</text><text id="SvgjsText1034" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="26.82456662095388" y="30.6875">r</text></g></g><g id="SvgjsG1035" transform="translate(941.1211239006337 187.6207833896026)" opacity="1"><path id="SvgjsPath1036" d="M0 0L129.89276123046875 0L129.89276123046875 200.1674041748047L0 200.1674041748047Z " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="#ccff99" opacity="1"></path><g id="SvgjsG1037" transform="matrix(1 0 0 1 10 83.83370467971042)" fill="#ffffff"><text id="SvgjsText1038" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="54.94638079870654" y="14.4375">ChannelHandler</text><text id="SvgjsText1039" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="54.94638079870654" y="30.6875">Context</text></g></g><g id="SvgjsG1040" transform="translate(969.4216323953272 256.0991076441413)" opacity="1"><path id="SvgjsPath1041" d="M0 4Q0 0 4 0L73.02828216552734 0Q77.02828216552734 0 77.02828216552734 4L77.02828216552734 118.9098129272461Q77.02828216552734 122.9098129272461 73.02828216552734 122.9098129272461L4 122.9098129272461Q0 122.9098129272461 0 118.9098129272461Z " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="#99ffff" opacity="1"></path><g id="SvgjsG1042" transform="matrix(1 0 0 1 10 53.329906382278345)" fill="#ffffff"><text id="SvgjsText1043" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="28.51413977817586" y="14.4375">Handler</text></g></g><g id="SvgjsG1044"><path id="SvgjsPath1045" d="M678.3763427734375 235.56797790527344L715.545166015625 235.56797790527344L715.545166015625 235.56797790527344L737.4779052734375 235.56797790527344 " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1046)"></path><g id="SvgjsG1048" transform="matrix(1 0 0 1 707.9271262517893 227.4429852817599)" fill="#ffffff"><path id="SvgjsPath1049" d="M0 0H0V0H0V0Z " fill="#ffffff" transform="translate(0 0)"></path><text id="SvgjsText1050" font-family="Microsoft Yahei,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="0" font-style="" text-anchor="middle" text-decoration="" x="0" y="0"></text></g></g><g id="SvgjsG1051"><path id="SvgjsPath1052" d="M752.7139892578125 329.75L715.3639526367188 329.75L715.3639526367188 329.7882080078125L693.2499389648438 329.7882080078125 " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1053)"></path><g id="SvgjsG1055" transform="matrix(1 0 0 1 722.9628735877857 321.62498899849743)" fill="#ffffff"><path id="SvgjsPath1056" d="M0 0H0V0H0V0Z " fill="#ffffff" transform="translate(0 0)"></path><text id="SvgjsText1057" font-family="Microsoft Yahei,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="0" font-style="" text-anchor="middle" text-decoration="" x="0" y="0"></text></g></g><g id="SvgjsG1058"><path id="SvgjsPath1059" d="M876.4445190429688 232.1431884765625L909.0679931640625 232.1431884765625L909.0679931640625 233.2729949951172L926.4553833007812 233.2729949951172 " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1060)"></path><g id="SvgjsG1062" transform="matrix(1 0 0 1 902.0148697435927 224.0181851466058)" fill="#ffffff"><path id="SvgjsPath1063" d="M0 0H0V0H0V0Z " fill="#ffffff" transform="translate(0 0)"></path><text id="SvgjsText1064" font-family="Microsoft Yahei,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="0" font-style="" text-anchor="middle" text-decoration="" x="0" y="0"></text></g></g><g id="SvgjsG1065"><path id="SvgjsPath1066" d="M941.6914672851562 343.891845703125L909.1513061523438 343.891845703125L909.1513061523438 343.891845703125L891.8472290039062 343.891845703125 " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1067)"></path><g id="SvgjsG1069" transform="matrix(1 0 0 1 916.769329694679 335.76683104739607)" fill="#ffffff"><path id="SvgjsPath1070" d="M0 0H0V0H0V0Z " fill="#ffffff" transform="translate(0 0)"></path><text id="SvgjsText1071" font-family="Microsoft Yahei,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="0" font-style="" text-anchor="middle" text-decoration="" x="0" y="0"></text></g></g><g id="SvgjsG1072" transform="translate(358.1529432879327 190.09768421742137)" opacity="1"><path id="SvgjsPath1073" d="M0 0L120.8609390258789 0L120.8609390258789 195.21360778808594L0 195.21360778808594Z " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="#ccff99" opacity="1"></path><g id="SvgjsG1074" transform="matrix(1 0 0 1 10 65.10680385189164)" fill="#ffffff"><text id="SvgjsText1075" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="50.43047110505708" y="14.4375">ChannelHandle</text><text id="SvgjsText1076" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="50.43047110505708" y="30.6875">rContext</text><text id="SvgjsText1077" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="50.43047110505708" y="46.9375">(Header)</text><text id="SvgjsText1078" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="50.43047110505708" y="48.75"></text></g></g><g id="SvgjsG1079" transform="translate(384.48563557678546 256.88128685292617)" opacity="1"><path id="SvgjsPath1080" d="M0 4Q0 0 4 0L67.67227935791016 0Q71.67227935791016 0 71.67227935791016 4L71.67227935791016 115.86800384521484Q71.67227935791016 119.86800384521484 67.67227935791016 119.86800384521484L4 119.86800384521484Q0 119.86800384521484 0 115.86800384521484Z " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="#99ffff" opacity="1"></path><g id="SvgjsG1081" transform="matrix(1 0 0 1 10 43.68400236519663)" fill="#ffffff"><text id="SvgjsText1082" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="25.836140249520085" y="14.4375">Handle</text><text id="SvgjsText1083" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="25.836140249520085" y="30.6875">r</text></g></g><g id="SvgjsG1084" transform="translate(1138.1529432879327 190.09768421742137)" opacity="1"><path id="SvgjsPath1085" d="M0 0L120.8609390258789 0L120.8609390258789 195.21360778808594L0 195.21360778808594Z " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="#ccff99" opacity="1"></path><g id="SvgjsG1086" transform="matrix(1 0 0 1 10 65.10680385189164)" fill="#ffffff"><text id="SvgjsText1087" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="50.43047110505708" y="14.4375">ChannelHandle</text><text id="SvgjsText1088" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="50.43047110505708" y="30.6875">rContext</text><text id="SvgjsText1089" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="50.43047110505708" y="46.9375">(Tail)</text><text id="SvgjsText1090" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="50.43047110505708" y="48.75"></text></g></g><g id="SvgjsG1091" transform="translate(1164.4856355767854 256.88128685292617)" opacity="1"><path id="SvgjsPath1092" d="M0 4Q0 0 4 0L67.67227935791016 0Q71.67227935791016 0 71.67227935791016 4L71.67227935791016 115.86800384521484Q71.67227935791016 119.86800384521484 67.67227935791016 119.86800384521484L4 119.86800384521484Q0 119.86800384521484 0 115.86800384521484Z " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="#99ffff" opacity="1"></path><g id="SvgjsG1093" transform="matrix(1 0 0 1 10 43.68400236519663)" fill="#ffffff"><text id="SvgjsText1094" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="25.836140249520085" y="14.4375">Handle</text><text id="SvgjsText1095" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="middle" text-decoration="blink" x="25.836140249520085" y="30.6875">r</text></g></g><g id="SvgjsG1096"><path id="SvgjsPath1097" d="M559.013916015625 326.7882080078125L518.513916015625 326.7882080078125L518.513916015625 326.7882080078125L493.24993896484375 326.7882080078125 " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1098)"></path><g id="SvgjsG1100" transform="matrix(1 0 0 1 526.1319194867967 318.66319274902344)" fill="#ffffff"><path id="SvgjsPath1101" d="M0 0H28.45309829711914V17.765640258789062H0V0Z " fill="#ffffff" transform="translate(-14.22654914855957 0)"></path><text id="SvgjsText1102" font-family="Microsoft Yahei,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="0" font-style="" text-anchor="middle" text-decoration="" x="0" y="14.4375">OUT</text></g></g><g id="SvgjsG1103"><path id="SvgjsPath1104" d="M478.0138854980469 236.78819274902344L518.513916015625 236.78819274902344L518.513916015625 236.78819274902344L543.77783203125 236.78819274902344 " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1105)"></path><g id="SvgjsG1107" transform="matrix(1 0 0 1 510.89585150929696 228.66319274902344)" fill="#ffffff"><path id="SvgjsPath1108" d="M0 0H14.750027656555176V17.765623092651367H0V0Z " fill="#ffffff" transform="translate(-7.375013828277588 0)"></path><text id="SvgjsText1109" font-family="Microsoft Yahei,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="0" font-style="" text-anchor="middle" text-decoration="" x="0" y="14.4375">IN</text></g></g><g id="SvgjsG1110"><path id="SvgjsPath1111" d="M1139.013916015625 342.7882080078125L1104.513916015625 342.7882080078125L1104.513916015625 342.7882080078125L1085.25 342.7882080078125 " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1112)"></path><g id="SvgjsG1114" transform="matrix(1 0 0 1 1112.1319194867967 334.66319274902344)" fill="#ffffff"><path id="SvgjsPath1115" d="M0 0H0V0H0V0Z " fill="#ffffff" transform="translate(0 0)"></path><text id="SvgjsText1116" font-family="Microsoft Yahei,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="0" font-style="" text-anchor="middle" text-decoration="" x="0" y="0"></text></g></g><g id="SvgjsG1117"><path id="SvgjsPath1118" d="M1070.013916015625 232.78819274902344L1104.513916015625 232.78819274902344L1104.513916015625 232.78819274902344L1123.77783203125 232.78819274902344 " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1119)"></path><g id="SvgjsG1121" transform="matrix(1 0 0 1 1096.895851509297 224.66319274902344)" fill="#ffffff"><path id="SvgjsPath1122" d="M0 0H0V0H0V0Z " fill="#ffffff" transform="translate(0 0)"></path><text id="SvgjsText1123" font-family="Microsoft Yahei,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="0" font-style="" text-anchor="middle" text-decoration="" x="0" y="0"></text></g></g><g id="SvgjsG1124" transform="translate(1324.0138854980469 262.78819274902344)" opacity="1"><path id="SvgjsPath1125" d="M0 4Q0 0 4 0L107.66665649414062 0Q111.66665649414062 0 111.66665649414062 4L111.66665649414062 131Q111.66665649414062 135 107.66665649414062 135L4 135Q0 135 0 131Z " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="#ffffff" opacity="1"></path><g id="SvgjsG1126" transform="matrix(1 0 0 1 10 10.625)" fill="#ffffff"><text id="SvgjsText1127" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="start" text-decoration="blink" x="0" y="14.4375">bind</text><text id="SvgjsText1128" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="start" text-decoration="blink" x="0" y="30.6875">connect</text><text id="SvgjsText1129" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="start" text-decoration="blink" x="0" y="46.9375">write</text><text id="SvgjsText1130" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="start" text-decoration="blink" x="0" y="63.1875">flush</text><text id="SvgjsText1131" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="start" text-decoration="blink" x="0" y="79.4375">read</text><text id="SvgjsText1132" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="start" text-decoration="blink" x="0" y="95.6875">disconnect</text><text id="SvgjsText1133" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="start" text-decoration="blink" x="0" y="111.9375">close</text></g></g><g id="SvgjsG1134"><path id="SvgjsPath1135" d="M1324.013916015625 330.2881774902344L1291.013916015625 330.2881774902344L1291.013916015625 329.7882080078125L1273.25 329.7882080078125 " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1136)"></path><g id="SvgjsG1138" transform="matrix(1 0 0 1 1298.3819194867967 322.16319274902344)" fill="#ffffff"><path id="SvgjsPath1139" d="M0 0H0V0H0V0Z " fill="#ffffff" transform="translate(0 0)"></path><text id="SvgjsText1140" font-family="Microsoft Yahei,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="0" font-style="" text-anchor="middle" text-decoration="" x="0" y="0"></text></g></g><g id="SvgjsG1141" transform="translate(70.6805419921875 179.78819274902344)" opacity="1"><path id="SvgjsPath1142" d="M0 4Q0 0 4 0L229 0Q233 0 233 4L233 120Q233 124 229 124L4 124Q0 124 0 120Z " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="#ffffff" opacity="1"></path><g id="SvgjsG1143" transform="matrix(1 0 0 1 10 21.375)" fill="#ffffff"><text id="SvgjsText1144" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="start" text-decoration="blink" x="0" y="14.4375">fireChannelReadComplete</text><text id="SvgjsText1145" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="start" text-decoration="blink" x="0" y="30.6875">fireExceptionCaught</text><text id="SvgjsText1146" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="start" text-decoration="blink" x="0" y="46.9375">fireUserEventTriggered</text><text id="SvgjsText1147" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="start" text-decoration="blink" x="0" y="63.1875">fireChannelWritabilityChanged</text><text id="SvgjsText1148" font-family="微软雅黑,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="normal" font-style="normal" text-anchor="start" text-decoration="blink" x="0" y="79.4375">fireChannelInactive</text></g></g><g id="SvgjsG1149"><path id="SvgjsPath1150" d="M303.6805419921875 241.78819274902344L331.1805419921875 241.78819274902344L331.1805419921875 241.78819274902344L343.4444885253906 241.78819274902344 " stroke-dasharray="" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1151)"></path><g id="SvgjsG1153" transform="matrix(1 0 0 1 323.56250800343764 233.66319274902344)" fill="#ffffff"><path id="SvgjsPath1154" d="M0 0H0V0H0V0Z " fill="#ffffff" transform="translate(0 0)"></path><text id="SvgjsText1155" font-family="Microsoft Yahei,宋体" text-rendering="optimize-speed" fill="#000000" font-size="13" font-weight="0" font-style="" text-anchor="middle" text-decoration="" x="0" y="0"></text></g></g></g></g></svg>
</DIV>